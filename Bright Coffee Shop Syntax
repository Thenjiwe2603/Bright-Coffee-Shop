SELECT *
FROM BRIGHTCOFFEESHOP.PUBLIC.BGTCOFFEESHOP
LIMIT 10;

----TIME BUCKET PER HOUR, MORNING, AFTERNOON, EVENING
--- TIME BUCKETS ON HOURLY INTERVALS
--- TIME TRANSACTACTIONAL DATE, GROUP DATE BY SPECIFIC DATE


---- MINIMUM TIME WHEN TRANSACTIONS OCCUR

SELECT MIN (TRANSACTION_TIME)
FROM BRIGHTCOFFEESHOP.PUBLIC.BGTCOFFEESHOP;

---- Maximum TIME WHEN TRANSACTIONS OCCUR
SELECT MAX(TRANSACTION_TIME)
FROM BRIGHTCOFFEESHOP.PUBLIC.BGTCOFFEESHOP;

SELECT TRANSACTION_DATE,
       COUNT(TRANSACTION_ID) NUMBER_OF_SALES,
       COUNT(PRODUCT_ID) AS UNIQUE_PRODUCTS_SOLD,
       SUM(TRANSACTION_QTY * TO_NUMBER(REPLACE(UNIT_PRICE, ',','.'))) TOTAL_AMOUNT,
       PRODUCT_CATEGORY,
       PRODUCT_DETAIL,
       PRODUCT_TYPE,
       STORE_LOCATION,
  CASE 
    WHEN TRANSACTION_TIME BETWEEN '06:00:00' AND '11:59:00' THEN 'MORNING'
    WHEN TRANSACTION_TIME BETWEEN '12:00:00' AND '13:59:00' THEN 'MIDDAY'
    WHEN TRANSACTION_TIME BETWEEN '14:00:00' AND '15:59:00' THEN 'AFTERNOON'
    WHEN TRANSACTION_TIME BETWEEN '16:00:00' AND '19:00:00' THEN 'EVENING'
    ELSE 'NIGHT'
    END AS TIME_BUCKETS
    FROM BRIGHTCOFFEESHOP.PUBLIC.BGTCOFFEESHOP
    GROUP BY ALL;


------Identify Slow Time Slots

SELECT 
  EXTRACT(HOUR FROM CAST(transaction_time AS TIME)) AS hour_of_day,
  COUNT(transaction_id) AS total_transactions,
  SUM(transaction_qty * CAST(unit_price AS FLOAT)) AS total_sales_amount
FROM BRIGHTCOFFEESHOP.PUBLIC.BGTCOFFEESHOP
GROUP BY EXTRACT(HOUR FROM CAST(transaction_time AS TIME))
ORDER BY hour_of_day;
